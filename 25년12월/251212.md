# 251212

### Spring Boot Yaml 내 List를 Property로 명시할때 사용법

yaml 파일 내 property로 sms.phones이라는 yaml을 작성할떄 아래처럼 작성가능



```
sms:
	targetPhone:
		- "010-1234-5678"
		- "010-2222-3333"
```

또는 아래처럼도 작성 가능하다.

```
sms:
	targetPhone: "010-1234-5678, 010-2222-3333"
```

- CF) 위와 같이 yaml에 작성했는데 소스 내에서 @Value로 작성하면 예외가 발생함
  - 해당 프로퍼티는 @ConditionalOnProperty를 사용하여 별도의 클래스로 분리하거나 "01012345678, 01023456123"와 같이 작성하고 @Value에서 SPEL을 이용해서 split을 활용하는 방안이 있음
    - <- 그 이유는, @Value("${}")자체가 애초에 Collecti



###  sh에서 ENV

ENV=$1

```
$0 : 스크립트 파일 이름
$1 : 첫번째 인자
$2 : 두번쨰 인자
$@ : 전체 인자 목록
```



```
./start.sh dev

-> ENV="dev"를 입력하게 된다.
```



### --spring.config.location

- 여러 설정 파일을 '여러 위치'에서 로딩하고, 뒤에 로딩된 설정이 앞의 로딩된 설정을 Override하는 규칙을 따름

- 2가지 방식이 존재

- classpath

  - ```
    --spring.config.location=classpath:/applicatino-prod.yaml
    ```

    - JAR 내부의 CLASSPATH에서 설정파일을 읽음

- file:

  - ```
    --spring.config.location=file:/home/..(중략)/application-prod.yaml
    ```

  - jar 재배포 없이도 외부 환경설정으로부터 환경변수 주입가능

- optional

  - 위의 2 설정의 경우 모두 해당설정이 없으면 애플리케이션 자체가 기동불가

  - 그러나 앞에 'optional'을 사용하면, 파일이 있으면 읽고, 없으면 무시하고 다음설정으로 진행한다.

  - ```
    --spring.config.location=optional:file:/home/(중략)/application-prod.yaml
    
    ```

- 중복사용

  - classpath방식, file방식, optional방식 모두를 종합적으로 사용가능함

  - ','를 기준으로 작성한다.

  - ex)

    - ```
      --spring.config.location=classpath:/application.yaml,optional:file:/home/app/config/application-prod.yaml
      
      ```

