# 251208





### @ConditionalOnProperty

```
2@Component
@ConditionalOnProperty(
        prefix = "batch.test",
        name = "fail-job-enabled",
        havingValue = "true"
)
@RequiredArgsConstructor
public class FailJobTestRunner implements CommandLineRunner {

    private final JobLauncher jobLauncher;
    private final Job failTestJob;

    @Override
    public void run(String... args) throws Exception {
        JobParameters params = new JobParametersBuilder()
                .addLong("timestamp", System.currentTimeMillis())
                .addString("reason", "sms-fail-test")
                .toJobParameters();

        jobLauncher.run(failTestJob, params);
    }
}

```

- name
  - 필수 속성 / 프로퍼티의 이름 지정
- value
  - name과 동일한 역할 수행
  - value를 사용하면 name은 생략 가능
- havingValue
  - 프로퍼티의 값과 일치해야하는 값을 지정
  - 기본값은 빈 문자열
  - 즉, 위의 예제에서 batch.test.fail-job-enabled라는 속성(이름)이 application.yaml 내에 존재하고 해당 값이 true일때만 위 Bean이 띄워지게 된다.
- prefix
  - 접두사
  - 위의 예에서 'batch.test'가 prefix
- matchIfMissing
  - 기본값은 false
  - 프로퍼티가 존재하지 않으면 빈이 생성 X







https://www.baeldung.com/spring-conditionalonproperty



### CommandLineRunner / ApplicationRunner

- ApplicationRunner

  - Boot에서 제공

  - CommandRunner와 유사하지만  ApplicationArguments라는 명령줄 인자를 좀 더 편리하게 처리가능

  - ApplicationRunner를 'implement'하는 Bean이 여러 개 있을때 @Order를 통해서 '순서'를 제어가능

  - ```
    @Bean
    @Order(1)
    public class InitDataBaseRunner implements ApplicationRunner{
    	public void run(ApplicationArguments args){
    		System.out.println("1. DB 초기화");
    	}
    
    }
    
    @Bean
    @Order(2)
    public class LoadCacheRunner Implements ApplicationRunner{
    	public void run(ApplicationArguments args){
    		System.out.println("2. 캐시 로드");
    	}
    }
    ```

    

- CommandLineRunner

  - Boot에서 제공
  - ApplicationRunner와 달리 String [] 형태의 명령줄 인자를 전달받음
  - 인자를 직접 파싱해야함

- 참고

  - SpringBoot Application 기동 프로세스	

    - 1. ApplicationContext 초기화

      2.  모든 Bean 생성·주입

      3. **ApplicationRunner & CommandLineRunner 실행**

      4. WebServer 시작 (web 환경일 경우)

### flock()





