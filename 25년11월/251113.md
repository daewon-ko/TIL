# 251113



### Filter 초기화

- Filter의 경우엔 Servlet 스펙
  - 공식 문서에 따르면 다른 빈들의 즉시 초기화를 초래하지 않도록 매우 주의해야한다고 한다.
    - 예를들면 필터 스펙에서 DataSource나 Jpa Configuration 관련한 Bean을 물고있거나 하는 등
  - 위 한계를 빈을 초기화 시점이 아니라, 사용 시점에 LAZY하게 지연로딩하면 된다고 한다.



```
However, you must be very careful that they do not cause eager initialization of too many other beans, because they have to be installed in the container very early in the application lifecycle. (For example, it is not a good idea to have them depend on your DataSource or JPA configuration.) You can work around such restrictions by initializing the beans lazily when first used instead of on initialization.
```

참고 

https://docs.spring.io/spring-boot/how-to/webserver.html#howto.webserver.add-servlet-filter-listener.spring-bean



---



### Filter단에서 예외가 발생하면?

본인이.. 면접을 받았던 질문이다.

여기서 말하는 Filter는 Security의 필터를 구현하는 필터와 다른 Servlet Spec의 필터를 구현하는 필터를 말한다.

- DispatcherServlet 이하의 Bean들과 다르게 해당 필터는 DispatcherServlet 앞단에 위치
  - 따라서 @ControllerAdvice, @ExceptionHandler등이 catch할 수 없다.
- 해당 Filter에서 예외 발생시, Tomcat까지 올라간다.
- Tomcat은 예외를 잡는데, Spring Boot의 경우 'ErrorPageFilter'라는 기본 필터를 등록해놨다.
- ErrorPageFilter는 해당 예외를 BasicErrorController로 넘긴다.
- 따라서 톰캣이 기본적으로 내리는 HTML에러페이지가 아